#! clean build -dtSa "-O2 -fPIC" -p test -l -pthread

name: mkn.ram

parent: lib

profile:
  - name: base
    inc: ./inc
    if_inc:
        bsd: ./os/nixish/inc
        nix: ./os/nixish/inc
        win: ./os/win/inc
    src: ./src
    if_src:
        bsd: ./os/nixish/src
        nix: ./os/nixish/src
        win: ./os/win/src

  - name: lib
    parent: base
    dep:
      - name: mkn.kul
        version: master
    if_arg:
        win_shared: -DKUL_SHARED -DKUL_EXPORT

  - name: https
    parent: lib
    arg: -D_KUL_INCLUDE_HTTPS_
    if_mod:
      win:
        - name: conan.install
          arg:
            init:
              install: -s compiler="Visual Studio" -s compiler.version=15
    if_lib:
      nix: ssl crypto
      bsd: ssl crypto
      win: User32 Crypt32 libssl libcrypto

  - name: fcgi
    parent: lib
    arg: -D_KUL_INCLUDE_FCGI_

  - name: c++0x
    parent: base
    dep:
      - name: mkn.kul
        version: master
        profile: c++0x

  - name: usage
    self: lib
    main: usage.cpp

  - name: test_fcgi
    main: test/fcgi.cpp
    self: fcgi

  - name: test
    parent: lib
    main: test.cpp

  - name: test.client
    parent: lib
    main: test/client.cpp

  - name: test.server
    parent: lib
    main: test/server.cpp
